<!DOCTYPE html>
<html lang="en">

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add Member</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  

  <div id="navbar"></div>

  <h1 div class="pl-20 ml-20 text-5xl pt-8 text-white">Welcome to the Add Member Page</h1>
  
  <body class="body-background"></body>
 


<body class="bg-blue-100">
  <main class="py-8 px-4 flex flex-col lg:flex-row gap-8">

    <!-- Registration Form -->
    <div class="flex-1 max-w-xl mx-auto bg-white p-6 rounded-lg shadow-lg">
      <h2 class="text-2xl font-semibold mb-6 text-gray-800">Registration Form</h2>
      <form id="registration-form" class="space-y-6">
        <div class="relative">
          <input type="text" name="id" placeholder="Enter ID" required class="pl-10 pr-4 py-2 border rounded-lg w-full border-gray-300 focus:border-[#4070f4] focus:ring-[#4070f4] focus:ring-1">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <i class="fas fa-id-badge text-[#4070f4]"></i>
          </div>
        </div>
        <div class="relative">
          <input type="date" name="expiry" id="expiry" value="2024-01-01" min="2024-01-01" max="2030-12-31" required class="pl-10 pr-4 py-2 border rounded-lg w-full border-gray-300 focus:border-[#4070f4] focus:ring-[#4070f4] focus:ring-1">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <i class="fas fa-calendar-alt text-[#4070f4]"></i>
          </div>
        </div>
        <div class="relative">
          <select name="membership" required class="pl-10 pr-4 py-2 border rounded-lg w-full border-gray-300 focus:border-[#4070f4] focus:ring-[#4070f4] focus:ring-1">
            <option value="" disabled selected>Membership</option>
            <option value="Gold">Gold</option>
            <option value="Silver">Silver</option>
            <option value="Bronze">Bronze</option>
          </select>
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <i class="fas fa-list text-[#4070f4]"></i>
          </div>
        </div>
        <div class="relative">
          <input type="text" name="firstName" placeholder="Enter First Name" required class="pl-10 pr-4 py-2 border rounded-lg w-full border-gray-300 focus:border-[#4070f4] focus:ring-[#4070f4] focus:ring-1">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <i class="fas fa-user text-[#4070f4]"></i>
          </div>
        </div>
        <div class="relative">
          <input type="text" name="lastName" placeholder="Enter Last Name" required class="pl-10 pr-4 py-2 border rounded-lg w-full border-gray-300 focus:border-[#4070f4] focus:ring-[#4070f4] focus:ring-1">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <i class="fas fa-user text-[#4070f4]"></i>
          </div>
        </div>
        <div class="relative">
          <input type="text" name="phoneNumber" placeholder="Enter Phone Number" required class="pl-10 pr-4 py-2 border rounded-lg w-full border-gray-300 focus:border-[#4070f4] focus:ring-[#4070f4] focus:ring-1">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <i class="fas fa-phone text-[#4070f4]"></i>
          </div>
        </div>
        <div class="relative">
          <input type="text" name="address" placeholder="Enter Address" required class="pl-10 pr-4 py-2 border rounded-lg w-full border-gray-300 focus:border-[#4070f4] focus:ring-[#4070f4] focus:ring-1">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <i class="fas fa-city text-[#4070f4]"></i>
          </div>
        </div>
        <div>
          <input type="submit" value="Submit" class="bg-[red] text-white py-2 px-4 rounded-lg w-full cursor-pointer hover:bg-[#3050d6]">
        </div>
      </form>
    </div>

    <!-- Members List -->
    <div class="flex-1 bg-white p-6 rounded-lg shadow-lg">
      <h2 class="text-2xl font-semibold mb-6 text-gray-600">Members List</h2>
      <table id="data-table" class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-xl">ID</th>
            <th class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-xl">ID Card</th>
            <th class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-xl">Expiry</th>
            <th class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-xl">Membership</th>
            <th class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-xl">First Name</th>
            <th class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-xl">Last Name</th>
            <th class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-xl">Phone Number</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <!-- Data will be populated here -->
        </tbody>
      </table>
      <div class="flex justify-between items-center mt-4">
        <button id="btn_prev" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded">Prev</button>
        <span class="text-2xl">Page: <span class="text-2xl" id="page"></span></span>
        <button id="btn_next" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded">Next</button>
      </div>
    </div>

    <!-- Update Form -->
    <div class="flex-1 max-w-xl mx-auto bg-white p-6 rounded-lg shadow-lg">
      <h2 class="text-2xl font-semibold mb-6 text-gray-800">Update Form</h2>
      <form id="update-form" class="space-y-6">
        <div class="relative">
          <input type="text" name="id" placeholder="Enter ID" required class="pl-10 pr-4 py-2 border rounded-lg w-full border-gray-300 focus:border-[#4070f4] focus:ring-[#4070f4] focus:ring-1">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <i class="fas fa-id-badge text-[#4070f4]"></i>
          </div>
        </div>
        <div class="relative">
          <input type="date" name="expiry" id="expiry" value="2024-01-01" min="2024-01-01" max="2030-12-31" required class="pl-10 pr-4 py-2 border rounded-lg w-full border-gray-300 focus:border-[#4070f4] focus:ring-[#4070f4] focus:ring-1">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <i class="fas fa-calendar-alt text-[#4070f4]"></i>
          </div>
        </div>
        <div class="relative">
          <select name="membership" required class="pl-10 pr-4 py-2 border rounded-lg w-full border-gray-300 focus:border-[#4070f4] focus:ring-[#4070f4] focus:ring-1">
            <option value="" disabled selected>Membership</option>
            <option value="Gold">Gold</option>
            <option value="Silver">Silver</option>
            <option value="Bronze">Bronze</option>
          </select>
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <i class="fas fa-list text-[#4070f4]"></i>
          </div>
        </div>
        <div>
          <input type="submit" value="Update" class="bg-[red] text-white py-2 px-4 rounded-lg w-full cursor-pointer hover:bg-[#3050d6]">
        </div>
      </form>
    </div>
    
  </main>
</body>





<style>
  @import url('https://fonts.googleapis.com/css?family=Poppins:400,500,600,700&display=swap');

  .body-background{
    background: #4070f4;
    min-height: 85vh;
  }


</style>







<!---show navbar-->
<script>
  document.addEventListener("DOMContentLoaded", function() {
      fetch('navbar.html')
        .then(response => response.text())
        .then(data => {
          document.getElementById('navbar').innerHTML = data;
        });
  });
</script>

<!---register member-->
<script>
  
    // Handle form submission
    document.getElementById('registration-form').addEventListener('submit', async function(event) {
      event.preventDefault();
      const formData = new FormData(this);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch('/register/gym_member', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data),
        });

        const result = await response.json();
        if (result.success) {
          alert(result.message);
          await fetchData(); // Refresh data after successful registration
        } else {
          alert(result.message);
        }
      } catch (error) {
        console.error('Error:', error);
        alert('An error occurred while registering the member.');
      }
    });
</script>

<!--show database-->
<script>
  var current_page = 1;
  var records_per_page = 8;

  async function fetchData() {
    try {
      const response = await fetch('/post/customers');
      const result = await response.json();
      
      if (result.success) {
        const rows = result.data.map(item => {
          return `
            <tr>
              <td class="px-4 py-4 whitespace-nowrap">${item.ID || 'N/A'}</td>
              <td class="px-5 py-4 whitespace-nowrap">${item.ID_CARD  || 'N/A'}</td>
              <td class="px-5 py-4 whitespace-nowrap">${item.Expiry ? new Date(item.Expiry).toLocaleDateString() : 'N/A'}</td>
              <td class="px-5 py-4 whitespace-nowrap">${item.Membership || 'N/A'}</td>
              <td class="px-5 py-4 whitespace-nowrap">${item.First_Name || 'N/A'}</td>
              <td class="px-5 py-4 whitespace-nowrap">${item.Last_Name || 'N/A'}</td>
              <td class="px-5 py-4 whitespace-nowrap">${item.Phone_Number || 'N/A'}</td>
            </tr>
          `;
        });

        function changePage(page) {
          const tbody = document.querySelector('#data-table tbody');
          tbody.innerHTML = ''; // Clear existing rows

          if (page < 1) page = 1;
          if (page > numPages()) page = numPages();

          const start = (page - 1) * records_per_page;
          const end = start + records_per_page;

          const paginatedData = rows.slice(start, end);
          tbody.innerHTML = paginatedData.join('');

          document.getElementById("page").innerHTML = page;

          if (page == 1) {
            document.getElementById("btn_prev").style.visibility = "hidden";
          } else {
            document.getElementById("btn_prev").style.visibility = "visible";
          }

          if (page == numPages()) {
            document.getElementById("btn_next").style.visibility = "hidden";
          } else {
            document.getElementById("btn_next").style.visibility = "visible";
          }
        }

        function prevPage() {
          if (current_page > 1) {
            current_page--;
            changePage(current_page);
          }
        }

        function nextPage() {
          if (current_page < numPages()) {
            current_page++;
            changePage(current_page);
          }
        }

        function numPages() {
          return Math.ceil(rows.length / records_per_page);
        }

        document.getElementById("btn_prev").addEventListener('click', prevPage);
        document.getElementById("btn_next").addEventListener('click', nextPage);

        changePage(current_page);

      } else {
        throw new Error(result.message);
      }
    } catch (error) {
      document.getElementById('error').textContent = `Error fetching data: ${error.message}`;
    }
  }

  window.onload = fetchData;

</script>

<!--update mbmer-->
<script>

// Handle form submission
document.getElementById('update-form').addEventListener('submit', async function(event) {
      event.preventDefault();
      const formData = new FormData(this);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch('/update/gym_member', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data),
        });

        const result = await response.json();
        if (result.success) {
          alert(result.message);
          await fetchData(); // Refresh data after successful registration
        } else {
          alert(result.message);
        }
      } catch (error) {
        console.error('Error:', error);
        alert('An error occurred while registering the member.');
      }
    });

</script>