

<!DOCTYPE html>
<html lang="en">

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add Member</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  
  <style>
    .container {
        display: flex;
        flex-direction: column;
        gap: 16px;
        padding: 16px;
        max-width: 1200px;
        margin: auto;
    }

    .table-container {
        background-color: white;
        padding: 24px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
    }

    .forms-row {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
    }

    .form-container {
        flex: 1;
        background-color: white;
        padding: 24px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        max-width: 100%;
    }

    h2 {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 16px;
    }

    .form-group {
        position: relative;
        margin-bottom: 16px;
    }

    .form-group input,
    .form-group select {
        width: 100%;
        padding: 12px 12px 12px 40px;
        border: 1px solid #ccc;
        border-radius: 8px;
    }

    .icon {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
    }

    .btn {
        background-color: red;
        color: white;
        padding: 12px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        text-align: center;
        width: 100%;
    }

    .btn:hover {
        background-color: #3050d6;
    }

    .table-container table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 16px;
    }

    .table-container th,
    .table-container td {
        padding: 12px;
        border-bottom: 1px solid #ccc;
        text-align: left;
    }

    .pagination {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .pagination .btn {
        width: auto;
        padding: 8px 16px;
    }

    #myInput {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 8px;
        box-sizing: border-box;
    }
</style>

  <div id="navbar"></div>

  <h1 div class="pl-20 ml-20 text-5xl pt-8 text-white">Welcome to the Add Member Page</h1>
  
<body class="body-background"></body>

</head>
<body>

<main class="container">
<!-- Members List -->
<div class="table-container">
    <h2>Members List</h2>
    <!-- Search input outside of table -->
    <input type="text" id="myInput" onkeyup="myFunction()" placeholder="Search for names...">
    <table id="data-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>ID Card</th>
                <th>Expiry</th>
                <th>Membership</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Phone Number</th>
            </tr>
        </thead>
        <tbody id="data-body">
            <!-- Data will be populated here -->
        </tbody>
    </table>
    <!-- Pagination controls -->
    <div class="pagination">
        <button id="btn_prev" class="btn">Prev</button>
        <span>Page: <span id="page"></span></span>
        <button id="btn_next" class="btn">Next</button>
    </div>
</div>

<!-- Forms Row -->
<div class="forms-row">
    <!-- Registration Form -->
    <div class="form-container">
        <h2>Registration Form</h2>
        <form id="registration-form">
            <div class="form-group">
                <input type="text" name="id" placeholder="Enter ID" required>
                <div class="icon">
                    <i class="fas fa-id-badge"></i>
                </div>
            </div>
            <div class="form-group">
                <input type="date" name="expiry" id="expiry" value="2024-01-01" min="2024-01-01" max="2030-12-31" required>
                <div class="icon">
                    <i class="fas fa-calendar-alt"></i>
                </div>
            </div>
            <div class="form-group">
                <select name="membership" required>
                    <option value="" disabled selected>Membership</option>
                    <option value="Gold">Gold</option>
                    <option value="Silver">Silver</option>
                    <option value="Bronze">Bronze</option>
                </select>
                <div class="icon">
                    <i class="fas fa-list"></i>
                </div>
            </div>
            <div class="form-group">
                <input type="text" name="firstName" placeholder="Enter First Name" required>
                <div class="icon">
                    <i class="fas fa-user"></i>
                </div>
            </div>
            <div class="form-group">
                <input type="text" name="lastName" placeholder="Enter Last Name" required>
                <div class="icon">
                    <i class="fas fa-user"></i>
                </div>
            </div>
            <div class="form-group">
                <input type="text" id='onlyNumber' name="phoneNumber" placeholder="Enter Phone Number" required>
                <div class="icon">
                    <i class="fas fa-phone"></i>
                </div>
            </div>
            <div class="form-group">
                <input type="text" name="address" placeholder="Enter Address" required>
                <div class="icon">
                    <i class="fas fa-city"></i>
                </div>
            </div>
            <div>
                <input type="submit" value="Submit" class="btn">
            </div>
        </form>
    </div>

    <!-- Update Form -->
    <div class="form-container">
        <h2>Update Form</h2>
        <form id="update-form">
            <div class="form-group">
                <input type="text" name="id" placeholder="Enter ID" required>
                <div class="icon">
                    <i class="fas fa-id-badge"></i>
                </div>
            </div>
            <div class="form-group">
                <input type="date" name="expiry" id="expiry" value="2024-01-01" min="2024-01-01" max="2030-12-31" required>
                <div class="icon">
                    <i class="fas fa-calendar-alt"></i>
                </div>
            </div>
            <div class="form-group">
                <select name="membership" required>
                    <option value="" disabled selected>Membership</option>
                    <option value="Gold">Gold</option>
                    <option value="Silver">Silver</option>
                    <option value="Bronze">Bronze</option>
                </select>
                <div class="icon">
                    <i class="fas fa-list"></i>
                </div>
            </div>
            <div>
                <input type="submit" value="Update" class="btn">
            </div>
        </form>
    </div>
</div>




</main>

</body>
</html>

<style>
  @import url('https://fonts.googleapis.com/css?family=Poppins:400,500,600,700&display=swap');

  .body-background{
    background: #4070f4;
    min-height: 85vh;
  }


</style>







<!---show navbar-->
<script>
  document.addEventListener("DOMContentLoaded", function() {
      fetch('navbar.html')
        .then(response => response.text())
        .then(data => {
          document.getElementById('navbar').innerHTML = data;
        });
  });
</script>

<!---register member-->
<script>
  
    // Handle form submission
    document.getElementById('registration-form').addEventListener('submit', async function(event) {
      event.preventDefault();
      const formData = new FormData(this);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch('/register/gym_member', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data),
        });

        const result = await response.json();
        if (result.success) {
          alert(result.message);
          await fetchData(); // Refresh data after successful registration
        } else {
          alert(result.message);
        }
      } catch (error) {
        console.error('Error:', error);
        alert('An error occurred while registering the member.');
      }
    });
</script>

<!--show database-->
<script>
  var current_page = 1;
  var records_per_page = 8;

  async function fetchData() {
    try {
      const response = await fetch('/post/customers');
      const result = await response.json();
      
      if (result.success) {
        const rows = result.data.map(item => {
          return `
           <tr>
              <td class="px-4 py-4 whitespace-nowrap">${item.ID || 'N/A'}</td>
              <td class="px-5 py-4 whitespace-nowrap">${item.ID_CARD  || 'N/A'}</td>
              <td class="px-5 py-4 whitespace-nowrap">${item.Expiry ? new Date(item.Expiry).toLocaleDateString() : 'N/A'}</td>
              <td class="px-5 py-4 whitespace-nowrap">${item.Membership || 'N/A'}</td>
              <td class="px-5 py-4 whitespace-nowrap">${item.First_Name || 'N/A'}</td>
              <td class="px-5 py-4 whitespace-nowrap">${item.Last_Name || 'N/A'}</td>
              <td class="px-5 py-4 whitespace-nowrap">${item.Phone_Number || 'N/A'}</td>
            </tr>
          `;
        });

        function changePage(page) {
          const tbody = document.querySelector('#data-table tbody');
          tbody.innerHTML = ''; // Clear existing rows

          if (page < 1) page = 1;
          if (page > numPages()) page = numPages();

          const start = (page - 1) * records_per_page;
          const end = start + records_per_page;

          const paginatedData = rows.slice(start, end);
          tbody.innerHTML = paginatedData.join('');

          document.getElementById("page").innerHTML = page;

          if (page == 1) {
            document.getElementById("btn_prev").style.visibility = "hidden";
          } else {
            document.getElementById("btn_prev").style.visibility = "visible";
          }

          if (page == numPages()) {
            document.getElementById("btn_next").style.visibility = "hidden";
          } else {
            document.getElementById("btn_next").style.visibility = "visible";
          }
        }

        function prevPage() {
          if (current_page > 1) {
            current_page--;
            changePage(current_page);
          }
        }

        function nextPage() {
          if (current_page < numPages()) {
            current_page++;
            changePage(current_page);
          }
        }

        function numPages() {
          return Math.ceil(rows.length / records_per_page);
        }

        document.getElementById("btn_prev").addEventListener('click', prevPage);
        document.getElementById("btn_next").addEventListener('click', nextPage);

        changePage(current_page);

      } else {
        throw new Error(result.message);
      }
    } catch (error) {
      document.getElementById('error').textContent = `Error fetching data: ${error.message}`;
    }
  }

  window.onload = fetchData;

</script>

<!--update mbmer-->
<script>

// Handle form submission
      document.getElementById('update-form').addEventListener('submit', async function(event) {
      event.preventDefault();
      const formData = new FormData(this);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch('/update/gym_member', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data),
        });

        const result = await response.json();
        if (result.success) {
          alert(result.message);
          await fetchData(); // Refresh data after successful registration
        } else {
          alert(result.message);
        }
      } catch (error) {
        console.error('Error:', error);
        alert('An error occurred while registering the member.');
      }
    });

</script>


<!-- filter name of member-->
<!-- Filter name of member -->
<script>
  function myFunction() {
    // Declare variables
    var input, filter, table, rows, i, txtValue;
    input = document.getElementById('myInput');
    filter = input.value.toUpperCase();
    table = document.getElementById("data-table");
    rows = table.getElementsByTagName('tr');

    // Loop through all table rows, and hide those who don't match the search query
    for (i = 1; i < rows.length; i++) { // Start at 1 to skip the header row
      let firstName = rows[i].getElementsByTagName("td")[4]; // First Name is in the 5th column
      let lastName = rows[i].getElementsByTagName("td")[5]; // Last Name is in the 6th column
      
      if (firstName || lastName) {
        let firstNameValue = firstName.textContent || firstName.innerText;
        let lastNameValue = lastName.textContent || lastName.innerText;
        txtValue = (firstNameValue + " " + lastNameValue).toUpperCase(); // Combine first and last names

        if (txtValue.indexOf(filter) > -1) {
          rows[i].style.display = "";
        } else {
          rows[i].style.display = "none";
        }
      }
    }
  }
</script>


<!--script for only accept number-->
<script>
  document.getElementById('onlyNumber').addEventListener('input', function (e) {
// Replace any non-digit characters with an empty string
this.value = this.value.replace(/\D/g, '');
});
</script>